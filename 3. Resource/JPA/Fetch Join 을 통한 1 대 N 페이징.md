
Entity의 OneToMany관게에서 fetch 타입을 Lazy 또는 Eager를 많이 사용하는데
이렇게 되면 비즈니스로직에서 1 대 다 관계에 있는 엔티티를 사용하려고할때 쿼리가 한 번 더
나가게 되는 N+1 문제가 생기게 된다.

이 문제를 해결하는 방법은 jpa의 fetch join을 사용하면 되는데 fetch join을 사용하게되면
한방쿼리로 관련된 엔티티를 한꺼번에 가져올수 있게된다. 

하지만 fetch join으로 모든 문제가 해결되는 것이 아니다. 
1 대 다 관계에서 fetch join의 문제점은 

> [!quote] 페이징이 안된다는 것

이다. 왜냐면 RDB에서는 1 대 다관계를 한줄로 표현할수 없기때문에 여러줄로 나타나게 되는데 이때 페이징을 사용하게 되면 원치않는 데이터가 나오게 될것이다.


> [!faq] 그래서 해결방법은?
> 1 대 다 관계에서 fetch join을 통해 N+1 문제도 해겷하면서 페이징도 할 수 있는 방법은
> JPA의 batch size를 활용하면 된다. batch size를 설정하게 되면 연관된 엔티티를 가져올때
> IN 쿼리를 통해 한번에 가져 올 수 있다. 

결국 페이징하고자 하는 엔티티 select 쿼리 1개와 1 대 다 관계로 연관된 엔티티를 in 쿼리로 select하는 쿼리
총 2개가 나가게 되지만 N+1 해결 및 페이징을 하고자한다면 좋은 해결책이 될 것이다.


